(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6],{5006:(e,n,r)=>{"use strict";r.r(n),r.d(n,{default:()=>o});var t=r(5155),i=r(2115),a=r(5752),c=r.n(a);function o(e){let{center:n,taxis:r,selectedTaxi:a,onTaxiSelect:o}=e,s=(0,i.useRef)(null),l=(0,i.useRef)(null),d=(0,i.useRef)(new Map),u=(0,i.useRef)(null);return(0,i.useEffect)(()=>{if(l.current&&!s.current)return s.current=c().map(l.current).setView([n.lat,n.lng],13),c().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(s.current),()=>{s.current&&(s.current.remove(),s.current=null)}},[]),(0,i.useEffect)(()=>{if(!s.current)return;u.current&&s.current.removeLayer(u.current);let e=c().divIcon({className:"user-location-marker",html:'\n        <div style="\n          width: 20px; \n          height: 20px; \n          background: #3B82F6; \n          border: 3px solid white; \n          border-radius: 50%; \n          box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);\n        "></div>\n      ',iconSize:[20,20],iconAnchor:[10,10]});u.current=c().marker([n.lat,n.lng],{icon:e}).addTo(s.current).bindPopup("Your Location"),s.current.setView([n.lat,n.lng],13)},[n]),(0,i.useEffect)(()=>{s.current&&(d.current.forEach(e=>{s.current&&s.current.removeLayer(e)}),d.current.clear(),r.forEach(e=>{let n=(null==a?void 0:a.id)===e.id,r="available"===e.status,t=c().divIcon({className:"taxi-marker",html:'\n          <div style="\n            width: 32px; \n            height: 32px; \n            background: '.concat(r?n?"#059669":"#10B981":"#6B7280","; \n            border: 3px solid ").concat(n?"#ffffff":"transparent",'; \n            border-radius: 8px; \n            display: flex; \n            align-items: center; \n            justify-content: center;\n            box-shadow: 0 2px 8px rgba(0,0,0,0.3);\n            position: relative;\n          ">\n            <svg width="18" height="18" viewBox="0 0 24 24" fill="white">\n              <path d="M5 11L6.5 6.5H17.5L19 11M17.5 16C16.67 16 16 15.33 16 14.5S16.67 13 17.5 13 19 13.67 19 14.5 18.33 16 17.5 16M6.5 16C5.67 16 5 15.33 5 14.5S5.67 13 6.5 13 8 13.67 8 14.5 7.33 16 6.5 16M17 8H7L5.5 12V17H6.5C6.5 18.1 7.4 19 8.5 19S10.5 18.1 10.5 17H13.5C13.5 18.1 14.4 19 15.5 19S17.5 18.1 17.5 17H18.5V12L17 8Z"/>\n            </svg>\n            ').concat(n?'<div style="position: absolute; top: -8px; right: -8px; width: 16px; height: 16px; background: #EF4444; border: 2px solid white; border-radius: 50%;"></div>':"","\n          </div>\n        "),iconSize:[32,32],iconAnchor:[16,16]}),i=c().marker([e.currentLocation.lat,e.currentLocation.lng],{icon:t}),l='\n        <div style="min-width: 200px;">\n          <h3 style="margin: 0 0 8px 0; font-weight: bold;">'.concat(e.driverName,'</h3>\n          <p style="margin: 0 0 4px 0; font-size: 12px; color: #666;">\n            ').concat(e.vehicleBrand," ").concat(e.vehicleModel," • ").concat(e.licensePlate,'\n          </p>\n          <div style="display: flex; align-items: center; margin: 4px 0;">\n            <span style="font-size: 12px; color: #666;">★ ').concat(e.rating," (").concat(e.totalTrips,' trips)</span>\n          </div>\n          <div style="background: #F3F4F6; padding: 8px; border-radius: 4px; margin: 8px 0;">\n            <div style="font-size: 12px; font-weight: bold; margin-bottom: 4px;">\n              Tariff ').concat(e.currentTariff.code,": ").concat(e.currentTariff.name,'\n            </div>\n            <div style="font-size: 11px; color: #666;">\n              Start: €').concat(e.currentTariff.startPrice.toFixed(2)," | \n              Per km: €").concat(e.currentTariff.pricePerKm.toFixed(2),'\n            </div>\n          </div>\n          <div style="display: flex; align-items: center; justify-content: space-between; margin-top: 8px;">\n            <span style="\n              padding: 2px 6px; \n              border-radius: 12px; \n              font-size: 11px; \n              background: ').concat(r?"#DCFCE7":"#F3F4F6",";\n              color: ").concat(r?"#166534":"#6B7280",';\n            ">\n              ').concat("available"===e.status?"".concat(e.estimatedArrival," min away"):"Busy","\n            </span>\n            ").concat(r?"\n              <button onclick=\"selectTaxi('".concat(e.id,'\')" style="\n                background: #3B82F6; \n                color: white; \n                border: none; \n                padding: 4px 8px; \n                border-radius: 4px; \n                font-size: 11px;\n                cursor: pointer;\n              ">\n                Select\n              </button>\n            '):"","\n          </div>\n        </div>\n      ");i.bindPopup(l),i.on("click",()=>{o(e)}),s.current&&(i.addTo(s.current),d.current.set(e.id,i))}),window.selectTaxi=e=>{let n=r.find(n=>n.id===e);n&&o(n)})},[r,a,o]),(0,i.useEffect)(()=>{if(!s.current||!a)return;let e=d.current.get(a.id);e&&(s.current.panTo([a.currentLocation.lat,a.currentLocation.lng]),e.openPopup())},[a]),(0,t.jsxs)("div",{className:"w-full h-full relative",children:[(0,t.jsx)("div",{ref:l,className:"w-full h-full rounded-lg",style:{minHeight:"400px"}}),(0,t.jsxs)("div",{className:"absolute top-4 right-4 bg-white p-3 rounded-lg shadow-md border border-gray-200 z-[1000]",children:[(0,t.jsx)("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Map Legend"}),(0,t.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-4 h-4 bg-blue-600 border border-white rounded-full mr-2"}),(0,t.jsx)("span",{children:"Your Location"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-6 h-6 bg-green-500 rounded mr-2 flex items-center justify-center",children:(0,t.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"white",children:(0,t.jsx)("path",{d:"M5 11L6.5 6.5H17.5L19 11M17.5 16C16.67 16 16 15.33 16 14.5S16.67 13 17.5 13 19 13.67 19 14.5 18.33 16 17.5 16M6.5 16C5.67 16 5 15.33 5 14.5S5.67 13 6.5 13 8 13.67 8 14.5 7.33 16 6.5 16M17 8H7L5.5 12V17H6.5C6.5 18.1 7.4 19 8.5 19S10.5 18.1 10.5 17H13.5C13.5 18.1 14.4 19 15.5 19S17.5 18.1 17.5 17H18.5V12L17 8Z"})})}),(0,t.jsx)("span",{children:"Available Taxi"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-6 h-6 bg-gray-500 rounded mr-2 flex items-center justify-center",children:(0,t.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"white",children:(0,t.jsx)("path",{d:"M5 11L6.5 6.5H17.5L19 11M17.5 16C16.67 16 16 15.33 16 14.5S16.67 13 17.5 13 19 13.67 19 14.5 18.33 16 17.5 16M6.5 16C5.67 16 5 15.33 5 14.5S5.67 13 6.5 13 8 13.67 8 14.5 7.33 16 6.5 16M17 8H7L5.5 12V17H6.5C6.5 18.1 7.4 19 8.5 19S10.5 18.1 10.5 17H13.5C13.5 18.1 14.4 19 15.5 19S17.5 18.1 17.5 17H18.5V12L17 8Z"})})}),(0,t.jsx)("span",{children:"Busy Taxi"})]})]})]}),(0,t.jsx)("div",{className:"absolute bottom-4 left-4 space-y-2 z-[1000]",children:(0,t.jsx)("button",{onClick:()=>{s.current&&u.current&&s.current.panTo([n.lat,n.lng])},className:"bg-white p-2 rounded-lg shadow-md border border-gray-200 hover:bg-gray-50 transition-colors",title:"Center on your location",children:(0,t.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:(0,t.jsx)("path",{d:"M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M3.05,13H1V11H3.05C3.5,6.83 6.83,3.5 11,3.05V1H13V3.05C17.17,3.5 20.5,6.83 20.95,11H23V13H20.95C20.5,17.17 17.17,20.5 13,20.95V23H11V20.95C6.83,20.5 3.5,17.17 3.05,13M12,5A7,7 0 0,0 5,12A7,7 0 0,0 12,19A7,7 0 0,0 19,12A7,7 0 0,0 12,5Z"})})})})]})}r(8413),delete c().Icon.Default.prototype._getIconUrl,c().Icon.Default.mergeOptions({iconRetinaUrl:"/leaflet/marker-icon-2x.png",iconUrl:"/leaflet/marker-icon.png",shadowUrl:"/leaflet/marker-shadow.png"})},8413:()=>{}}]);